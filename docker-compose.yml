version: '3'

services:
  #green page
  green:
    image: nginx
    volumes:
    - ./wwwg:/usr/share/nginx/html:ro
  #red page
  red:
    image: nginx
    volumes:
    - ./wwwr:/usr/share/nginx/html:ro

  # linkerd
  l5d:
    image: buoyantio/linkerd:1.5.0
    ports:
    - "4140:4140"
    - "9990:9990"
    volumes:
    - ./config/linkerd.yml:/io.buoyant/linkerd.yml:ro
    - ./disco:/io.buoyant/disco
    command: >
      /io.buoyant/linkerd.yml

  #namerd
  n5d:
    image: buoyantio/namerd:1.5.0
    ports: ["4100:4100", "4180:4180", "9991:9991"]
    volumes:
    - ./config/namerd.yml:/io.buoyant/namerd.yml:ro
    - ./disco:/io.buoyant/disco
    command: >
      /io.buoyant/namerd.yml

  #Zookeper
  zook:
    image: zookeeper
    restart: always
    hostname: zook
    ports:
      - 2181:2181
    environment:
      ZOO_MY_ID: 1
      ZOO_SERVERS: server.1=0.0.0.0:2888