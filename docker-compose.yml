version: '3'

services:
  # an nginx service serving static content
  green:
    image: nginx
    # mount the wwwg directory as the static content to serve
    volumes:
    - ./wwwg:/usr/share/nginx/html:ro

  red:
    image: nginx
    # mount the wwwr directory as the static content to serve
    volumes:
    - ./wwwr:/usr/share/nginx/html:ro

  # linkerd
  l5d:
    image: buoyantio/linkerd:1.4.6
    ports:
    - "4140:4140"
    - "9990:9990"
    # we must mount the config file and the disco directory
    volumes:
    - ./linkerd.yaml:/io.buoyant/linkerd.yaml:ro
    - ./disco:/io.buoyant/disco
    command: >
      /io.buoyant/linkerd.yaml
